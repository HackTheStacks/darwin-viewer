{"version":3,"sources":["app.controller.es6"],"names":[],"mappings":"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","file":"app.controller.js","sourcesContent":["import ResizableImage from './image-model.es6';\n\nfunction AppCtrl(AppService) {\n    var vm = this;\n    console.log('app ctrl loaded');\n\n    // Matching response\n\n    vm.answerMatch = function (matchValue) {\n        console.log('is match?', matchValue);\n        vm.nextImage();\n    };\n\n    vm.nextImage = function () {\n        vm.currMatchIndex++;\n        if (vm.currMatchIndex < vm.imageToMatch.matches.length) {\n            vm.currMatchImageSrc = '/api/fragments/' + vm.imageToMatch.matches[vm.currMatchIndex].targetId + '/image';\n        } else {\n            vm.endOfMatches = true;\n        }\n    };\n\n    vm.nextImageSet = function () {\n        vm.currentImageIndex++;\n        angular.extend(vm.imageToMatch, vm.images[vm.currentImageIndex]);\n        vm.endOfMatches = false;\n        vm.currMatchIndex = 0;\n    };\n\n\n    // Image\n\n\n\n    initialize();\n\n    function initialize() {\n        vm.loading = true;\n        AppService.getImages().then(function (response) {\n            console.log(response);\n            // vm.images = response.data.images;\n            vm.images = response.data;\n            console.log(vm.images);\n\n            angular.extend(vm.imageToMatch, vm.images[0]);\n            vm.potentialMatches = vm.imageToMatch.matches;\n            console.log('image to match', vm.imageToMatch);\n            vm.mainImageId = vm.images[0].id;\n            vm.currMatchImageSrc = '/api/fragments/' + vm.imageToMatch.matches[vm.currMatchIndex].targetId + '/image';\n\n            let testImg = new Image();\n            testImg.src = '/api/fragments/' + vm.imageToMatch.matches[vm.currMatchIndex].targetId + '/image';\n\n\n            testImg.onload = (e) => {\n                console.log(testImg.width);\n                let newImg = new Image();\n                newImg.src = testImg.src;\n                $(newImg).addClass('test-img');\n                $('.main-content').append(newImg);\n                renderOriginalImage(newImg);\n                // resizeableImage($(newImg));\n                var image = new ResizableImage($(newImg));\n            };\n            vm.loading = false;\n        });\n\n        function renderOriginalImage(img) {\n            let canvas = document.createElement('canvas');\n            let context = canvas.getContext('2d');\n\n            let base = new Image();\n            base.src = img.src;\n            base.onload = () => {\n                let ratio = base.height / base.width,\n                    newHeight = 200 / base.width * base.height;\n                canvas.width = 200;\n                canvas.height = newHeight;\n                console.log(ratio);\n                console.log(newHeight);\n                context.drawImage(base, 0, 0, 200, newHeight);\n                img.src = canvas.toDataURL('image/jpeg');\n            }\n        }\n\n        vm.images = [];\n        vm.imageToMatch = {};\n        vm.potentialMatches = [];\n        vm.currentImageIndex = 0;\n        vm.currMatchIndex = 0;\n        vm.endOfMatches = false;\n\n        // * CANVAS * //\n\n        // let canvas = document.getElementById('canvas');\n        // let context = canvas.getContext('2d');\n        // console.log(context);\n    }\n\n\n}\n\nexport default AppCtrl;"]}